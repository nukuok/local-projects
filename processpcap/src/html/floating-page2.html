<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"> 
<head> 
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" /> 
<title>sequence</title> 
<style type="text/css"> 
html,body{overflow:auto;} 
span{overflow:scroll} 
#box{position:absolute;width:300px;background:#ccc;border:1px solid #ccc;top:100%;left:0%;margin:-300px  0 0 0;}
</style> 
<script type="text/javascript"> 
window.onload=function () 
{ 
var oBox=document.getElementById("box"); 
var aSpan = oBox.getElementsByTagName("span"); 
var disX = disY = 0; 
var bDrag = false; 
//鼠标按下, 激活拖拽 
oBox.onmousedown = function (event) 
{ 
var event = event || window.event; 
bDrag = true; 
disX = event.clientX - oBox.offsetLeft; 
disY = event.clientY - oBox.offsetTop; 
this.setCapture && this.setCapture(); 
return false 
}; 

//拖拽开始 
document.onmousemove = function (event) 
{ 
if (!bDrag) return; 
var event = event || window.event; 
var iL = event.clientX - disX; 
var iT = event.clientY - disY; 
var maxL = document.documentElement.clientWidth - oBox.offsetWidth; 
var maxT = document.documentElement.clientHeight - oBox.offsetHeight; 
iL = iL < 0 ? 0 : iL; 
iL = iL > maxL ? maxL : iL; 

iT = iT < 0 ? 0 : iT; 
iT = iT > maxT ? maxT : iT; 
oBox.style.marginTop = oBox.style.marginLeft = 0; 
oBox.style.left = iL + "px"; 
oBox.style.top = iT + "px"; 
status(); 
return false 
}; 
//鼠标释放, 结束拖拽 
document.onmouseup = window.onblur = oBox.onlosecapture = function () 
{ 
bDrag = false; 
oBox.releaseCapture && oBox.releaseCapture(); 
status() 
}; 

//初始调用 
}; 
</script> 
</head> 
<body> 
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
abcdefg <br>
<div id="box"> 
<p><strong>Drag:</strong><span></span></p> 
<p><strong>offsetTop:</strong><span></span></p> 
<p><strong>offsetLeft:</strong><span></span></p> 
</div>
</body> 
</html> 
